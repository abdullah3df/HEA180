<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>حاسبة قص الجناح العلوي</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    function App(){
      const [b, setB] = useState(180);     // عرض الجناح (مم)
      const [theta, setTheta] = useState(16); // زاوية التجميع (°)

      // حساب s و r بالدرجات فقط
      const result = useMemo(()=>{
        if (!isFinite(b) || b<=0 || !isFinite(theta) || theta<=0 || theta>120) return null;
        const alphaDeg = theta / 2;                               // نصف الزاوية بالدرجات
        const alphaRad = alphaDeg * Math.PI / 180;                // للتحويل للحساب فقط
        const s = b * (1 - Math.cos(alphaRad));                   // المقطوع لكل قطعة
        const r = Math.max(0, b - s);                             // المتبقي
        return { s, r, alphaDeg };
      }, [b, theta]);

      // معاينة بخط واحد كما اتفقنا
      const svgBarMax = 320;
      const scale = b > 0 ? svgBarMax / b : 1;
      const cutPx = result ? Math.min(svgBarMax, result.s * scale) : 0;
      const remPx = result ? Math.max(0, svgBarMax - cutPx) : 0;

      return (
        <div dir="rtl" className="min-h-screen p-6">
          <div className="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6">
            <h1 className="text-2xl font-bold mb-2 text-center">حاسبة قص الجناح العلوي</h1>
            <p className="text-sm text-gray-600 text-center mb-4">
              أدخل عرض الجناح <span className="font-semibold">b</span> وزاوية التجميع <span className="font-semibold">θ</span>
              للحصول على مقدار القطع <span className="font-semibold">s</span> والمتبقي <span className="font-semibold">r</span>.
            </p>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2">
              <div>
                <label className="block font-semibold mb-1">عرض الجناح b (مم)</label>
                <input
                  type="number" min="1" step="0.1" value={b}
                  onChange={e=>setB(parseFloat(e.target.value)||0)}
                  className="w-full p-2 border rounded"
                />
              </div>

              <div>
                <label className="block font-semibold mb-1">
                  زاوية التجميع θ: <span className="font-bold"><span dir="ltr">{theta}°</span></span>
                </label>
                <input
                  type="range" min="5" max="60" step="1" value={theta}
                  onChange={e=>setTheta(parseFloat(e.target.value)||0)}
                  className="w-full"
                />
                <div className="text-xs text-gray-500 mt-1">
                  α = θ/2 = <span dir="ltr">{(theta/2).toFixed(2)}°</span>
                </div>
              </div>
            </div>

            {result ? (
              <>
                <div className="mt-4 bg-gray-50 border rounded p-4">
                  <h2 className="font-bold mb-3">النتائج</h2>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-3 text-center">
                    <div className="p-2 rounded bg-red-50 border border-red-200">
                      <div className="text-sm text-red-600">المقطوع لكل قطعة (s)</div>
                      <div className="text-xl font-bold text-red-700"><span dir="ltr">{result.s.toFixed(2)} mm</span></div>
                    </div>
                    <div className="p-2 rounded bg-emerald-50 border border-emerald-200">
                      <div className="text-sm text-emerald-700">المتبقي من الجناح (r)</div>
                      <div className="text-xl font-bold text-emerald-800"><span dir="ltr">{result.r.toFixed(2)} mm</span></div>
                    </div>
                    <div className="p-2 rounded bg-slate-50 border border-slate-200">
                      <div className="text-sm text-slate-600">عرض الجناح الأصلي (b)</div>
                      <div className="text-xl font-bold text-slate-800"><span dir="ltr">{b} mm</span></div>
                    </div>
                  </div>

                  <p className="mt-3 text-xs text-gray-600">
                    المعادلة: <span className="font-mono">s = b · (1 − cos(θ/2))</span>
                    &nbsp;→&nbsp;
                    <span className="font-mono">
                      s = {b} · (1 − cos(<span dir="ltr">{(theta/2).toFixed(2)}°</span>))
                    </span>
                  </p>
                </div>

                {/* المعاينة: خط واحد (أحمر = المقطوع، رمادي = المتبقي) */}
                <div className="mt-6 flex justify-center">
                  <svg width="380" height="80" viewBox="0 0 380 80" className="bg-white rounded shadow">
                    <line x1="30" y1="40" x2={30 + svgBarMax} y2="40" stroke="#e5e7eb" strokeWidth="10" />
                    <line x1="30" y1="40" x2={30 + cutPx} y2="40" stroke="#ef4444" strokeWidth="10" />
                    <line x1={30 + cutPx} y1="40" x2={30 + cutPx + remPx} y2="40" stroke="#6b7280" strokeWidth="10" />
                    <line x1="30" y1="52" x2={30 + cutPx} y2="52" stroke="#ef4444" strokeDasharray="4 3"/>
                    <text x={30 + cutPx/2} y="68" fontSize="11" textAnchor="middle" fill="#ef4444">
                      s = {result.s.toFixed(2)} mm
                    </text>
                    <line x1={30 + cutPx} y1="28" x2={30 + cutPx + remPx} y2="28" stroke="#6b7280" strokeDasharray="4 3"/>
                    <text x={30 + cutPx + remPx/2} y="20" fontSize="11" textAnchor="middle" fill="#374151">
                      r = {result.r.toFixed(2)} mm
                    </text>
                    <text x="30" y="24" fontSize="11" fill="#374151">b = {b} mm</text>
                  </svg>
                </div>
              </>
            ) : (
              <div className="mt-4 text-red-600">الرجاء إدخال قيم صحيحة.</div>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
