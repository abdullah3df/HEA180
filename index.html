<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>H-Träger – Flanschzuschnitt (nur oberer Flansch)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    // أبعاد تقريبية للرسم (رأس H فقط) — يمكنك تعديلها لاحقًا حسب جدولك
    const SECTION = {
      b: 180,   // عرض الجناح الكلي (mm)
      tf: 16,   // سماكة الجناح (العلوي/السفلي) (mm) — للرسم فقط
      tw: 10,   // سماكة العمود (web) (mm) — للرسم فقط
      hWeb: 120 // طول العمود الظاهر في الرسم (شكل توضيحي)
    };

    // SVG Beam Head (رأس مقطع H مبسّط)
    function BeamHead({ side="left", cut=15 }) {
      // side: "left" = إزالة شريط من طرف الجناح العلوي الأيسر
      //       "right" = إزالة شريط من طرف الجناح العلوي الأيمن
      const W = 420, H = 260;
      const cx = W/2, yTop = 80;      // مستوى الجناح العلوي
      const { b, tf, tw, hWeb } = SECTION;

      const half = b/2;
      const halfWeb = tw/2;

      // مواضع الحواف بالنسبة لمركز العمود
      const leftEdge  = cx - half;
      const rightEdge = cx + half;

      const webLeft  = cx - halfWeb;
      const webRight = cx + halfWeb;

      const topY1 = yTop;         // أعلى الجناح العلوي
      const topY2 = yTop + tf;    // أسفل الجناح العلوي
      const botY1 = yTop + hWeb;  // أعلى الجناح السفلي
      const botY2 = botY1 + tf;   // أسفل الجناح السفلي

      // القطع: شريط مستطيل من طرف واحد من الجناح العلوي فقط
      const cutLeft  = side === "left"  ? cut : 0;
      const cutRight = side === "right" ? cut : 0;

      // حدود الجناح العلوي بعد إزالة الشريط
      const topLeftX  = leftEdge  + cutLeft;   // إذا قطعنا من اليسار نزح اليمين
      const topRightX = rightEdge - cutRight;  // إذا قطعنا من اليمين نزح اليسار

      // ألوان
      const fillTop = side === "left" ? "#6366f1" : "#60a5fa";
      const strokeTop = side === "left" ? "#4338ca" : "#2563eb";

      return (
        <svg width={W} height={H} viewBox={`0 0 ${W} ${H}`} className="bg-white rounded-lg shadow-md">
          {/* الجناح العلوي بعد القص (مستطيل ناقص من طرف واحد) */}
          <rect x={topLeftX} y={topY1} width={topRightX - topLeftX} height={tf}
                fill={fillTop} stroke={strokeTop} strokeWidth="2"/>

          {/* المستطيل المزال (للتوضيح فقط) */}
          {cutLeft > 0 && (
            <rect x={leftEdge} y={topY1} width={cutLeft} height={tf}
                  fill="none" stroke="#ef4444" strokeDasharray="4 3" />
          )}
          {cutRight > 0 && (
            <rect x={rightEdge - cutRight} y={topY1} width={cutRight} height={tf}
                  fill="none" stroke="#ef4444" strokeDasharray="4 3" />
          )}

          {/* العمود (web) كامل غير مقطوع */}
          <rect x={webLeft} y={topY1} width={tw} height={hWeb}
                fill="#1e40af" opacity="0.75"/>

          {/* الجناح السفلي كامل غير مقطوع */}
          <rect x={leftEdge} y={botY1} width={b} height={tf}
                fill="#94a3b8" stroke="#64748b" strokeWidth="1"/>

          {/* حواف وإرشادات */}
          <line x1={cx - b/2} y1={topY1-14} x2={cx + b/2} y2={topY1-14} stroke="#999"/>
          <text x={cx} y={topY1-18} fontSize="10" fill="#666" textAnchor="middle">b = {b} mm</text>

          <text x={leftEdge-6} y={topY1+tf/2+3} fontSize="10" fill="#ef4444" textAnchor="end">
            {cutLeft > 0 ? `- ${cutLeft} mm` : ""}
          </text>
          <text x={rightEdge+6} y={topY1+tf/2+3} fontSize="10" fill="#ef4444">
            {cutRight > 0 ? `- ${cutRight} mm` : ""}
          </text>
        </svg>
      );
    }

    function App(){
      const [lang, setLang] = useState("de");
      const [show, setShow] = useState(false);   // لا نعرض إلا عند الطلب
      const [angle, setAngle] = useState(16);    // زاوية التجميع (عرض فقط)
      const [cut, setCut]     = useState(15);    // عرض الشريط المزال من الجناح العلوي (mm)

      const T = useMemo(()=>({
        de: {
          hello: "Willkommen bei der Winkelrechner",
          title: "Kopfansicht – Nur oberer Flansch schneiden (Streifen)",
          show: "Form anzeigen",
          hide: "Form ausblenden",
          angle: "Verbindungswinkel (°): (Anzeige)",
          cut: "Breite des entfernten Streifens im oberen Flansch (mm):",
          beforeA: "Stück A – Schnitt links (oberer Flansch nur)",
          beforeB: "Stück B – Schnitt rechts (oberer Flansch nur)",
          after: "Zusammenbau – Ansicht schematisch (Winkel nur zur Anzeige)"
        },
        ar: {
          hello: "مرحبًا بكم في حاسبة الزاوية",
          title: "رأس المقطع – قطع شريط من الجناح العلوي فقط",
          show: "إظهار الشكل",
          hide: "إخفاء الشكل",
          angle: "زاوية التجميع (°): (للعرض فقط)",
          cut: "عرض الشريط المزال من الجناح العلوي (مم):",
          beforeA: "القطعة A — قطع من الطرف الأيسر (الجناح العلوي فقط)",
          beforeB: "القطعة B — قطع من الطرف الأيمن (الجناح العلوي فقط)",
          after: "بعد التجميع — عرض تخطيطي (الزاوية للعرض فقط)"
        },
        en: {
          hello: "Welcome to the Angle Calculator",
          title: "Head View – Remove a rectangular strip from top flange only",
          show: "Show shape",
          hide: "Hide shape",
          angle: "Joint angle (°): (display only)",
          cut: "Removed strip width on top flange (mm):",
          beforeA: "Piece A — cut on left side (top flange only)",
          beforeB: "Piece B — cut on right side (top flange only)",
          after: "After assembly — schematic (angle display only)"
        }
      }[lang]),[lang]);

      const dir = lang==="ar" ? "rtl" : "ltr";
      const align = lang==="ar" ? "text-right" : "text-left";

      return (
        <div dir={dir} className={`min-h-screen p-6 ${align}`}>
          <div className="text-center bg-blue-100 text-blue-800 py-3 rounded-lg mb-4 text-lg font-semibold">
            {T.hello}
          </div>

          <div className="max-w-3xl mx-auto bg-white rounded-lg shadow-lg p-6">
            <div className="flex justify-between items-center mb-4">
              <h1 className="text-xl font-bold">{T.title}</h1>
              <select value={lang} onChange={e=>setLang(e.target.value)} className="p-2 border rounded">
                <option value="de">Deutsch</option>
                <option value="ar">العربية</option>
                <option value="en">English</option>
              </select>
            </div>

            {!show ? (
              <div className="text-center">
                <button className="px-5 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                        onClick={()=>setShow(true)}>
                  {T.show}
                </button>
              </div>
            ) : (
              <>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label className="block font-semibold mb-2">{T.angle}</label>
                    <input type="range" min="5" max="60" value={angle}
                           onChange={e=>setAngle(parseInt(e.target.value))}
                           className="w-full"/>
                    <div className="text-center mt-1 font-bold">{angle}°</div>
                  </div>
                  <div>
                    <label className="block font-semibold mb-2">{T.cut}</label>
                    <input type="number" min="1" max="80" step="1" value={cut}
                           onChange={e=>setCut(parseInt(e.target.value)||0)}
                           className="w-full p-2 border rounded"/>
                    <div className="text-xs text-gray-500 mt-1">
                      (لا نلمس العمود ولا الجناح السفلي — إزالة شريط مستقيم من طرف الجناح العلوي فقط)
                    </div>
                  </div>
                </div>

                <div className="mt-6 space-y-6">
                  <div>
                    <h3 className="font-semibold mb-2">{T.beforeA}</h3>
                    <BeamHead side="left" cut={cut}/>
                  </div>
                  <div>
                    <h3 className="font-semibold mb-2">{T.beforeB}</h3>
                    <BeamHead side="right" cut={cut}/>
                  </div>
                  <div>
                    <h3 className="font-semibold mb-2">{T.after} — {angle}°</h3>
                    {/* للعرض فقط: نظهر القطعتين متقابلتين (لا نميل السماكات، لأن القص مستطيل) */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                      <BeamHead side="left" cut={cut}/>
                      <BeamHead side="right" cut={cut}/>
                    </div>
                  </div>

                  <div className="text-center mt-4">
                    <button className="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
                            onClick={()=>setShow(false)}>
                      {lang==="ar" ? "إخفاء الشكل" : lang==="de" ? "Form ausblenden" : "Hide shape"}
                    </button>
                  </div>
                </div>
              </>
            )}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App/>);
  </script>
</body>
</html>
