<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>H-Träger – Zuschnittrechner</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React 18 (UMD) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    function App(){
      const [lang, setLang] = useState("de");
      const T = useMemo(()=>({
        de:{title:"Zuschnittrechner – oberer Flansch",desc:"Berechnen Sie die Streifenbreite s…",b:"Flanschbreite b (mm)",angle:"Verbindungswinkel θ (°)",result:"Ergebnis",perPiece:"Streifen pro Stück",show:"Bereich anzeigen",hide:"Bereich ausblenden"},
        ar:{title:"حاسبة قص الجناح العلوي",desc:"أدخل عرض الجناح b وزاوية التجميع المطلوبة θ.",b:"عرض الجناح b (مم)",angle:"زاوية التجميع θ (°)",result:"النتيجة",perPiece:"عرض الشريط لكل قطعة",show:"إظهار الحاسبة",hide:"إخفاء الحاسبة"},
        en:{title:"Top flange cut calculator",desc:"Enter flange width b and joint angle θ.",b:"Flange width b (mm)",angle:"Joint angle θ (°)",result:"Result",perPiece:"Strip per piece",show:"Show calculator",hide:"Hide calculator"}
      }[lang]),[lang]);

      const dir = lang==="ar" ? "rtl" : "ltr";
      const align = lang==="ar" ? "text-right" : "text-left";

      const [show, setShow] = useState(true);
      const [b, setB] = useState(180);
      const [theta, setTheta] = useState(16);

      const res = useMemo(()=>{
        if (!b || !theta) return null;
        const a = (theta/2) * Math.PI/180;
        const s = b * (1 - Math.cos(a));
        return { s, a };
      }, [b, theta]);

      const svgBarMax = 280;
      const scale = b > 0 ? svgBarMax / b : 1;
      const cutPx = res ? Math.min(svgBarMax, res.s * scale) : 0;

      return (
        <div dir={dir} className={`min-h-screen p-6 ${align}`}>
          <div className="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6">
            <div className="flex justify-between items-center">
              <h1 className="text-2xl font-bold">{T.title}</h1>
              <select value={lang} onChange={e=>setLang(e.target.value)} className="p-2 border rounded">
                <option value="de">Deutsch</option>
                <option value="ar">العربية</option>
                <option value="en">English</option>
              </select>
            </div>
            <p className="text-sm text-gray-600 mt-2">{T.desc}</p>

            {!show ? (
              <div className="text-center mt-4">
                <button className="px-5 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                        onClick={()=>setShow(true)}>{T.show}</button>
              </div>
            ) : (
              <>
                <div className="mt-4">
                  <label className="block font-semibold mb-1">{T.b}</label>
                  <input
                    type="number"
                    value={b}
                    onChange={e=>setB(parseFloat(e.target.value))}
                    className="w-full p-2 border rounded mb-4"
                  />

                  <label className="block font-semibold mb-1">{T.angle}: {theta}°</label>
                  <input
                    type="range"
                    min="5"
                    max="60"
                    step="1"
                    value={theta}
                    onChange={(e)=>setTheta(parseFloat(e.target.value))}
                    className="w-full"
                  />
                </div>

                {res && (
                  <div className="mt-6 bg-gray-50 p-4 rounded border">
                    <h2 className="font-bold mb-2">{T.result}</h2>
                    <p>{T.perPiece}: <span className="font-bold">{res.s.toFixed(2)} mm</span></p>
                  </div>
                )}

                {res && (
                  <div className="mt-6 flex justify-center">
                    <svg width="360" height="110" viewBox="0 0 360 110">
                      <rect x="20" y="40" width={svgBarMax} height="20" fill="#e5e7eb" stroke="#cbd5e1"/>
                      <rect x="20" y="40" width={cutPx} height="20" fill="#ef4444"/>
                      <text x="20" y="75" fontSize="11" fill="#ef4444">
                        s = {res.s.toFixed(2)} mm
                      </text>
                    </svg>
                  </div>
                )}

                <div className="text-center mt-6">
                  <button className="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
                          onClick={()=>setShow(false)}>{T.hide}</button>
                </div>
              </>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
