<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>H-Träger – Zuschnittrechner (oberer Flansch)</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React 18 (UMD) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    function App(){
      // افتراضي: لغة ألمانية كما طلبت سابقًا
      const [lang, setLang] = useState("de");
      const T = useMemo(()=>({
        de:{
          title:"Zuschnittrechner – oberer Flansch (Streifen entfernen)",
          desc:"Gib die Flanschbreite b und den gewünschten Verbindungswinkel θ an. Der Rechner ermittelt die Streifenbreite s, die an EINER Seite des oberen Flansches je Stück entfernt werden soll.",
          b:"Flanschbreite b (mm)",
          angle:"Verbindungswinkel θ (°)",
          result:"Ergebnis",
          perPiece:"Zu entfernender Streifen pro Stück",
          formula:"Formel",
          show:"Bereich anzeigen",
          hide:"Bereich ausblenden",
          note:"Der Zuschnitt ist ein gerader Streifen entlang der gesamten Länge; Steg (web) und unterer Flansch bleiben unverändert."
        },
        ar:{
          title:"حاسبة قص الجناح العلوي (إزالة شريط مستقيم)",
          desc:"أدخل عرض الجناح b وزاوية التجميع المطلوبة θ. الحاسبة تعطيك عرض الشريط s الواجب قطعه من طرف واحد من الجناح العلوي لكل قطعة.",
          b:"عرض الجناح b (مم)",
          angle:"زاوية التجميع θ (°)",
          result:"النتيجة",
          perPiece:"عرض الشريط المطلوب لكل قطعة",
          formula:"المعادلة",
          show:"إظهار الحاسبة",
          hide:"إخفاء الحاسبة",
          note:"القص هو شريط مستقيم بطول القطعة؛ لا نلمس العمود (web) ولا الجناح السفلي."
        },
        en:{
          title:"Top-flange cut calculator (remove rectangular strip)",
          desc:"Enter flange width b and target joint angle θ. The calculator returns strip width s to remove from ONE side of the top flange per piece.",
          b:"Flange width b (mm)",
          angle:"Joint angle θ (°)",
          result:"Result",
          perPiece:"Strip to remove per piece",
          formula:"Formula",
          show:"Show calculator",
          hide:"Hide calculator",
          note:"Cut is a straight strip along full length; web and bottom flange remain untouched."
        }
      }[lang]),[lang]);

      const dir = lang==="ar" ? "rtl" : "ltr";
      const align = lang==="ar" ? "text-right" : "text-left";

      const [show, setShow] = useState(true);
      const [b, setB] = useState(180);       // عرض الجناح (مم)
      const [theta, setTheta] = useState(16); // زاوية التجميع (°)

      // s = b * (1 - cos(theta/2))
      const calc = () => {
        if (!isFinite(b) || b<=0 || !isFinite(theta) || theta<=0 || theta>120) return null;
        const a = (theta/2) * Math.PI/180;
        const s = b * (1 - Math.cos(a));
        return { s, a };
      };
      const res = calc();

      return (
        <div dir={dir} className={`min-h-screen p-6 ${align}`}>
          <div className="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6">
            <div className="flex justify-between items-center">
              <h1 className="text-2xl font-bold">{T.title}</h1>
              <select value={lang} onChange={e=>setLang(e.target.value)} className="p-2 border rounded">
                <option value="de">Deutsch</option>
                <option value="ar">العربية</option>
                <option value="en">English</option>
              </select>
            </div>

            <p className="text-sm text-gray-600 mt-2">{T.desc}</p>

            <div className="mt-4">
              {!show ? (
                <div className="text-center">
                  <button className="px-5 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                          onClick={()=>setShow(true)}>{T.show}</button>
                </div>
              ) : (
                <>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label className="block font-semibold mb-1">{T.b}</label>
                      <input type="number" min="1" step="0.1" value={b}
                             onChange={e=>setB(parseFloat(e.target.value)||0)}
                             className="w-full p-2 border rounded"/>
                    </div>
                    <div>
                      <label className="block font-semibold mb-1">{T.angle}</label>
                      <input type="number" min="1" max="120" step="0.1" value={theta}
                             onChange={e=>setTheta(parseFloat(e.target.value)||0)}
                             className="w-full p-2 border rounded"/>
                    </div>
                  </div>

                  <div className="mt-4 text-sm text-gray-500">{T.note}</div>

                  {/* النتيجة */}
                  <div className="mt-6 bg-gray-50 p-4 rounded border">
                    <h2 className="font-bold mb-2">{T.result}</h2>
                    {res ? (
                      <>
                        <p className="text-lg">
                          {T.perPiece}: <span className="font-bold">{res.s.toFixed(2)} mm</span>
                        </p>
                        <p className="mt-2 text-gray-600">
                          {T.formula}: s = b · (1 − cos(θ/2)) → s = {b} · (1 − cos({(theta/2).toFixed(2)}°))
                        </p>
                      </>
                    ) : (
                      <p className="text-red-600">تحقق من المدخلات.</p>
                    )}
                  </div>

                  {/* رسم توضيحي مبسّط */}
                  {res && (
                    <div className="mt-6 flex justify-center">
                      <svg width="360" height="110" viewBox="0 0 360 110" className="bg-white rounded-lg shadow">
                        <!-- الجناح قبل القص -->
                        <rect x="20" y="40" width="280" height="20" fill="#e5e7eb" stroke="#cbd5e1"/>
                        <!-- الشريط المزال (يسار كمثال) -->
                        <rect x="20" y="40" width={Math.min(280, res.s)} height="20" fill="#ef4444" opacity="0.9"/>
                        <!-- أبعاد -->
                        <line x1="20" x2="300" y1="30" y2="30" stroke="#9ca3af"/>
                        <text x="160" y="25" font-size="11" text-anchor="middle" fill="#374151">b = {b} mm</text>
                        <text x="20" y="75" font-size="11" fill="#ef4444">s = {res.s.toFixed(2)} mm</text>
                      </svg>
                    </div>
                  )}

                  <div className="text-center mt-6">
                    <button className="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
                            onClick={()=>setShow(false)}>{T.hide}</button>
                  </div>
                </>
              )}
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App/>);
  </script>
</body>
</html>
